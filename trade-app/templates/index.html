<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SFM トレード支援ツール</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        /* 読み込み中のアニメーション */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: none; /* 最初は隠す */
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="p-4 md:p-8 max-w-2xl mx-auto">

    <header class="mb-6">
        <h1 class="text-2xl font-bold flex items-center gap-2 mb-2">
            <span class="text-red-500 text-3xl">📈</span>
            SFM トレード支援ツール（5分足＋板 → AI判定）
        </h1>
        <p class="text-sm text-gray-700 leading-relaxed">
            上部で登録した銘柄の「日足・材料などの環境」を保存しておくと、5分足＋板で判定するたびに、その環境情報も自動で考慮してくれます。
        </p>
    </header>

    <section class="bg-white rounded-xl p-5 shadow-sm mb-6 border border-gray-100">
        <h2 class="font-bold text-lg mb-2 flex items-center gap-2">
            <span class="text-green-500 text-xl">✅</span>
            登録済み銘柄
        </h2>
        <div id="savedStocks" class="text-gray-500 text-sm">
            まだ登録された銘柄はありません。下のフォームから登録してください。
        </div>
    </section>

    <section class="bg-white rounded-xl p-6 shadow-sm border border-gray-100 mb-8">
        <h2 class="font-bold text-lg mb-4">① 5分足＋板から短期アクションを判定</h2>

        <form id="predictionForm" class="space-y-5" onsubmit="return false;">
            
            <div>
                <label class="block text-gray-700 text-sm font-medium mb-1">銘柄コード（判定する対象）</label>
                <input type="text" id="ticker" placeholder="例: 9434" class="w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <div>
                <label class="block text-gray-700 text-sm font-medium mb-1">5分足チャート画像</label>
                <div class="flex items-center gap-2 mb-1">
                    <label class="cursor-pointer bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1.5 rounded text-sm transition">
                        ファイルを選択
                        <input type="file" id="chartImg" class="hidden" accept="image/*">
                    </label>
                    <span id="chartImgName" class="text-sm text-gray-500">ファイル未選択</span>
                </div>
            </div>

            <div>
                <label class="block text-gray-700 text-sm font-medium mb-1">気配値（板）画像</label>
                <div class="flex items-center gap-2 mb-1">
                    <label class="cursor-pointer bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1.5 rounded text-sm transition">
                        ファイルを選択
                        <input type="file" id="boardImg" class="hidden" accept="image/*">
                    </label>
                    <span id="boardImgName" class="text-sm text-gray-500">ファイル未選択</span>
                </div>
            </div>

            <div>
                <label class="block text-gray-700 text-sm font-medium mb-1">補足メモ（任意）</label>
                <textarea id="memo" placeholder="例: 自分のエントリー価格や、直近のニュースなど" class="w-full border border-gray-300 rounded-lg p-3 h-24 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"></textarea>
            </div>

            <button type="button" onclick="handlePredict()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-full transition shadow-md flex justify-center items-center gap-2">
                <span>AIに判定してもらう</span>
                <div class="loader" id="loadingSpinner"></div>
            </button>

        </form>
    </section>

    <section class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
        <h2 class="font-bold text-lg mb-4">② 日足・材料などの環境情報を登録</h2>
        <form class="space-y-4" onsubmit="return false;">
            <div>
                <label class="block text-gray-700 text-sm font-medium mb-1">銘柄コード</label>
                <input type="text" placeholder="例: 9434" class="w-full border border-gray-300 rounded-lg p-3">
            </div>
            <div>
                 <label class="block text-gray-700 text-sm font-medium mb-1">日足・環境認識メモ</label>
                <textarea placeholder="例: 上昇トレンド中。決算通過済み。" class="w-full border border-gray-300 rounded-lg p-3 h-20 resize-none"></textarea>
            </div>
             <button class="w-full bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 rounded-lg transition">
                環境情報を保存する
            </button>
        </form>
    </section>

    <script>
        // ファイル名を表示する機能
        document.getElementById('chartImg').addEventListener('change', function(e){
            if(e.target.files[0]) document.getElementById('chartImgName').innerText = e.target.files[0].name;
        });
        document.getElementById('boardImg').addEventListener('change', function(e){
            if(e.target.files[0]) document.getElementById('boardImgName').innerText = e.target.files[0].name;
        });

        // 判定ボタンが押された時の処理
        function handlePredict() {
            // ローディング表示
            const spinner = document.getElementById('loadingSpinner');
            spinner.style.display = 'block';

            // エラー回避のため、本来のフォーム送信は無効化済み
            // ここにAIとの通信処理（API連携）を後で書くことになる
            
            setTimeout(() => {
                spinner.style.display = 'none';
                alert('【テスト成功】\nサーバー送信エラーは回避されました！\n\n※今はまだAIのAPIキーが設定されていないので、ここまでしか動きません。\n次はAPIキーを設定して、実際に判定できるようにしましょう。');
            }, 1000);
        }
    </script>
</body>
</html>
